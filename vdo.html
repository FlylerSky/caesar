<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>One Cinema Test</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* L·ªõp overlay v√¥ h√¨nh ch·∫∑n thao t√°c */
    #overlayBlock {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: transparent;
      z-index: 10;
    }
    #playerWrapper {
      position: relative;
      width: 640px;
      height: 360px;
    }
  </style>
</head>
<body class="bg-gray-900 text-white min-h-screen flex flex-col items-center justify-center">

  <h1 class="text-3xl font-bold mb-6">üé¨ Test C√¥ng Chi·∫øu (Kh√≥a & Auto Play)</h1>

  <!-- Form nh·∫≠p link -->
  <div class="flex space-x-2 mb-6">
    <input id="youtubeUrl" type="text" 
           placeholder="D√°n link YouTube..."
           class="w-80 px-3 py-2 rounded-lg text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500">
    <button onclick="playVideo()" 
            class="px-4 py-2 bg-blue-600 rounded-lg hover:bg-blue-700 transition">
      Ph√°t
    </button>
  </div>

  <!-- Player b·ªçc trong wrapper + overlay -->
  <div id="playerWrapper" class="rounded-xl overflow-hidden shadow-lg">
    <div id="player"></div>
    <div id="overlayBlock"></div>
  </div>

  <script src="https://www.youtube.com/iframe_api"></script>
  <script>
    let player;

    function onYouTubeIframeAPIReady() {
      player = new YT.Player('player', {
        height: '360',
        width: '640',
        videoId: '', // ban ƒë·∫ßu ƒë·ªÉ tr·ªëng
        playerVars: {
          autoplay: 0,   // ban ƒë·∫ßu off, khi load m·ªõi on
          controls: 0,   // ·∫©n controls
          disablekb: 1,  // ch·∫∑n b√†n ph√≠m
          modestbranding: 1,
          rel: 0,
          fs: 0,
          iv_load_policy: 3
        },
        events: {
          'onStateChange': onPlayerStateChange
        }
      });
    }

    function onPlayerStateChange(event) {
      if (event.data === YT.PlayerState.ENDED) {
        alert("‚úÖ Test th√†nh c√¥ng t√≠nh nƒÉng d·ª´ng c√¥ng chi·∫øu!");
      }
    }

    function extractVideoId(url) {
      try {
        let videoId = null;
        if (url.includes("youtube.com/watch?v=")) {
          const urlObj = new URL(url);
          videoId = urlObj.searchParams.get("v");
        } else if (url.includes("youtu.be/")) {
          videoId = url.split("youtu.be/")[1].split("?")[0];
        }
        return videoId;
      } catch (e) {
        return null;
      }
    }

    function playVideo() {
      const url = document.getElementById("youtubeUrl").value.trim();
      const id = extractVideoId(url);
      if (id) {
        player.loadVideoById({
          videoId: id,
          startSeconds: 0,
          suggestedQuality: "hd720"
        });
        player.playVideo(); // auto play sau khi load
      } else {
        alert("‚ùå Kh√¥ng nh·∫≠n d·∫°ng ƒë∆∞·ª£c link YouTube!");
      }
    }
  </script>
</body>
</html>
